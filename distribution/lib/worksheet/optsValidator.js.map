{"version":3,"sources":["../../../source/lib/worksheet/optsValidator.js"],"names":["types","require","optsTypes","getObjItem","obj","key","returnObj","levels","split","length","thisLevelKey","shift","e","validator","val","type","sizes","Object","keys","paperSize","indexOf","TypeError","join","pageOrder","validate","orientation","positiveUniversalMeasure","cellComment","printError","pane","paneState","parseFloat","parseInt","traverse","o","keyParts","func","i","thisKeyParts","concat","thisKey","thisType","thisItem","module","exports","opts"],"mappings":"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","file":"optsValidator.js","sourcesContent":["const types = require('../types/index.js');\r\n\r\nconst optsTypes = {\r\n    'margins': {\r\n        'bottom': 'Float',\r\n        'footer': 'Float',\r\n        'header': 'Float',\r\n        'left': 'Float',\r\n        'right': 'Float',\r\n        'top': 'Float'\r\n    },\r\n    'printOptions': {\r\n        'centerHorizontal': 'Boolean',\r\n        'centerVertical': 'Boolean',\r\n        'printGridLines': 'Boolean',\r\n        'printHeadings': 'Boolean'\r\n    \r\n    },\r\n    'pageSetup': {\r\n        'blackAndWhite': 'Boolean',\r\n        'cellComments': 'CELL_COMMENTS',\r\n        'copies': 'Integer',\r\n        'draft': 'Boolean',\r\n        'errors': 'PRINT_ERROR',\r\n        'firstPageNumber': 'Boolean',\r\n        'fitToHeight': 'Integer',\r\n        'fitToWidth': 'Integer',\r\n        'horizontalDpi': 'Integer',\r\n        'orientation': 'ORIENTATION',\r\n        'pageOrder': 'PAGE_ORDER',\r\n        'paperHeight': 'POSITIVE_UNIVERSAL_MEASURE',\r\n        'paperSize': 'PAPER_SIZE',\r\n        'paperWidth': 'POSITIVE_UNIVERSAL_MEASURE',\r\n        'scale': 'Integer',\r\n        'useFirstPageNumber': 'Boolean',\r\n        'usePrinterDefaults': 'Boolean',\r\n        'verticalDpi': 'Integer'\r\n    },\r\n    'headerFooter': {\r\n        'evenFooter': 'String',\r\n        'evenHeader': 'String',\r\n        'firstFooter': 'String',\r\n        'firstHeader': 'String',\r\n        'oddFooter': 'String',\r\n        'oddHeader': 'String',\r\n        'alignWithMargins': 'Boolean',\r\n        'differentFirst': 'Boolean',\r\n        'differentOddEven': 'Boolean',\r\n        'scaleWithDoc': 'Boolean'\r\n    },\r\n    'sheetView': {\r\n        'pane': {\r\n            'activePane': 'PANE',\r\n            'state': 'PANE_STATE',\r\n            'topLeftCell': null,\r\n            'xSplit': null,\r\n            'ySplit': null\r\n        },\r\n        'tabSelected': null,\r\n        'workbookViewId': null,\r\n        'rightToLeft': null,\r\n        'showGridLines': null,\r\n        'zoomScale': null,\r\n        'zoomScaleNormal': null,\r\n        'zoomScalePageLayoutView': null\r\n    },\r\n    'sheetFormat': {\r\n        'baseColWidth': null,\r\n        'customHeight': null,\r\n        'defaultColWidth': null,\r\n        'defaultRowHeight': null,\r\n        'outlineLevelCol': null,\r\n        'outlineLevelRow': null,\r\n        'thickBottom': null,\r\n        'thickTop': null,\r\n        'zeroHeight': null\r\n    },\r\n    'sheetProtection': {\r\n        'autoFilter': null,\r\n        'deleteColumns': null,\r\n        'deleteRow': null,\r\n        'formatCells': null,\r\n        'formatColumns': null,\r\n        'formatRows': null,\r\n        'hashValue': null,\r\n        'insertColumns': null,\r\n        'insertHyperlinks': null,\r\n        'insertRows': null,\r\n        'objects': null,\r\n        'password': null,\r\n        'pivotTables': null,\r\n        'scenarios': null,\r\n        'selectLockedCells': null,\r\n        'selectUnlockedCell': null,\r\n        'sheet': null,\r\n        'sort': null\r\n    },\r\n    'outline': {\r\n        'summaryBelow': null\r\n    },\r\n    'autoFilter': {\r\n        'startRow': null,\r\n        'endRow': null,\r\n        'startCol': null,\r\n        'endCol': null,\r\n        'filters': null\r\n    },\r\n    'hidden': 'Boolean'\r\n};\r\n\r\nlet getObjItem = (obj, key) => {\r\n    let returnObj = obj;\r\n    let levels = key.split('.');\r\n\r\n    while (levels.length > 0) {\r\n        let thisLevelKey = levels.shift();\r\n        try {\r\n            returnObj = returnObj[thisLevelKey];\r\n        } catch (e) {\r\n            //returnObj = undefined;\r\n        }\r\n    }\r\n    return returnObj;\r\n};\r\n\r\nlet validator = function (key, val, type) {\r\n    switch (type) {\r\n\r\n    case 'PAPER_SIZE': \r\n        let sizes = Object.keys(types.paperSize);\r\n        if (sizes.indexOf(val) < 0) {\r\n            throw new TypeError('Invalid value for ' + key + '. Value must be one of ' + sizes.join(', '));\r\n        }\r\n        break;\r\n\r\n    case 'PAGE_ORDER':\r\n        types.pageOrder.validate(val);\r\n        break;\r\n\r\n    case 'ORIENTATION':\r\n        types.orientation.validate(val);\r\n        break;\r\n\r\n    case 'POSITIVE_UNIVERSAL_MEASURE': \r\n        types.positiveUniversalMeasure.validate(val);\r\n        break;\r\n\r\n    case 'CELL_COMMENTS':\r\n        types.cellComment.validate(val);\r\n        break;\r\n\r\n    case 'PRINT_ERROR': \r\n        types.printError.validate(val);\r\n        break;\r\n\r\n    case 'PANE':\r\n        types.pane.validate(val);\r\n        break;\r\n\r\n    case 'PANE_STATE':\r\n        types.paneState.validate(val);\r\n        break;\r\n\r\n    case 'Boolean':\r\n        if ([true, false, 1, 0].indexOf(val) < 0) {\r\n            throw new TypeError(key + ' expects value of true, false, 1 or 0');\r\n        }\r\n        break;\r\n\r\n    case 'Float': \r\n        if (parseFloat(val) !== val) {\r\n            throw new TypeError(key + ' expects value as a Float number');\r\n        }\r\n        break;\r\n\r\n    case 'Integer':\r\n        if (parseInt(val) !== val) {\r\n            throw new TypeError(key + ' expects value as an Integer');\r\n        }\r\n        break;\r\n\r\n    case 'String': \r\n        if (typeof val !== 'string') {\r\n            throw new TypeError(key + ' expects value as a String');\r\n        }\r\n        break;\r\n\r\n    default:\r\n        break;\r\n    }\r\n};\r\n\r\nlet traverse = function (o, keyParts, func) {\r\n    for (let i in o) {\r\n        let thisKeyParts = keyParts.concat(i);\r\n        let thisKey = thisKeyParts.join('.');\r\n        let thisType = getObjItem(optsTypes, thisKey);\r\n\r\n        if (typeof thisType === 'string') {\r\n            let thisItem = o[i];\r\n            func(thisKey, thisItem, thisType); \r\n        }\r\n        if (o[i] !== null && typeof o[i] === 'object') {\r\n            traverse(o[i], thisKeyParts, func);\r\n        }\r\n    }\r\n};\r\n\r\nmodule.exports = (opts) => {\r\n    traverse(opts, [], validator);\r\n};"]}