{"version":3,"sources":["../../../../source/lib/worksheet/cf/cf_rules_collection.js"],"names":["CfRule","require","CfRulesCollection","rulesBySqref","sqref","ruleConfig","rules","newRule","push","ele","Object","keys","forEach","thisEle","att","rule","addToXMLele","up","length","module","exports"],"mappings":";;;;;;AAAA,IAAMA,SAASC,QAAQ,WAAR,CAAf;;AAEA;;IAEMC,iB;AAAoB;AACtB,iCAAc;AAAA;;AACV;AACA,aAAKC,YAAL,GAAoB,EAApB;AACH;;;;4BAMGC,K,EAAOC,U,EAAY;AACnB,gBAAIC,QAAQ,KAAKH,YAAL,CAAkBC,KAAlB,KAA4B,EAAxC;AACA,gBAAIG,UAAU,IAAIP,MAAJ,CAAWK,UAAX,CAAd;AACAC,kBAAME,IAAN,CAAWD,OAAX;AACA,iBAAKJ,YAAL,CAAkBC,KAAlB,IAA2BE,KAA3B;AACA,mBAAO,IAAP;AACH;;;oCAEWG,G,EAAK;AAAA;;AACbC,mBAAOC,IAAP,CAAY,KAAKR,YAAjB,EAA+BS,OAA/B,CAAuC,UAACR,KAAD,EAAW;AAC9C,oBAAIS,UAAUJ,IAAIA,GAAJ,CAAQ,uBAAR,EAAiCK,GAAjC,CAAqC,OAArC,EAA8CV,KAA9C,CAAd;AACA,sBAAKD,YAAL,CAAkBC,KAAlB,EAAyBQ,OAAzB,CAAiC,UAACG,IAAD,EAAU;AACvCA,yBAAKC,WAAL,CAAiBH,OAAjB;AACH,iBAFD;AAGAA,wBAAQI,EAAR;AACH,aAND;AAOH;;;4BApBW;AACR,mBAAOP,OAAOC,IAAP,CAAY,KAAKR,YAAjB,EAA+Be,MAAtC;AACH;;;;;;AAsBLC,OAAOC,OAAP,GAAiBlB,iBAAjB","file":"cf_rules_collection.js","sourcesContent":["const CfRule = require('./cf_rule');\r\n\r\n// -----------------------------------------------------------------------------\r\n\r\nclass CfRulesCollection { // ยง18.3.1.18 conditionalFormatting (Conditional Formatting)\r\n    constructor() {\r\n        // rules are indexed by cell refs\r\n        this.rulesBySqref = {};\r\n    }\r\n\r\n    get count() {\r\n        return Object.keys(this.rulesBySqref).length;\r\n    }\r\n\r\n    add(sqref, ruleConfig) {\r\n        let rules = this.rulesBySqref[sqref] || [];\r\n        let newRule = new CfRule(ruleConfig);\r\n        rules.push(newRule);\r\n        this.rulesBySqref[sqref] = rules;\r\n        return this;\r\n    }\r\n\r\n    addToXMLele(ele) {\r\n        Object.keys(this.rulesBySqref).forEach((sqref) => {\r\n            let thisEle = ele.ele('conditionalFormatting').att('sqref', sqref);\r\n            this.rulesBySqref[sqref].forEach((rule) => {\r\n                rule.addToXMLele(thisEle);\r\n            });\r\n            thisEle.up();\r\n        });\r\n    }\r\n}\r\n\r\n\r\nmodule.exports = CfRulesCollection;"]}