{"version":3,"sources":["../../../source/lib/drawing/chart.js"],"names":["Drawing","require","xmlbuilder","EMU","uuidv4","v4","Chart","opts","kind","type","_title","chartData","indexOf","position","anchor","from","to","x","y","TypeError","ele","anchorEle","anchorType","att","_position","af","anchorFrom","afEle","text","col","colOff","row","rowOff","anchorTo","at","atEle","width","height","graphicFrame","nvGraphicFramePr","cNvPrEle","id","xfrm","graphicData","rId","xmlcx","xchart","title","title_rich","titlep","titlepr","plotArea","layout","ml","barChart","catAx","valAx","sno","dataSeries","sx","ser","label","ptrn","pattern","range","catRange","dLbl","xlabel","font","genTxPrXML","genTitleXML","ylabel","xmlc","txtRun","xz_xlabc","xz_xlab","xz_xlabp","fontSize","xz_xlabpr","title_txt","bold","italic","value","fx","legend","txPr","txPrp","_name","newName","_id","_descr","desc","_extension","inWidth","_pxWidth","emu","inHeight","_pxHeight","module","exports"],"mappings":"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","file":"chart.js","sourcesContent":["const Drawing = require('./drawing.js');\r\nconst xmlbuilder = require('xmlbuilder');\r\nconst EMU = require('../classes/emu.js')\r\nconst { v4: uuidv4 } = require('uuid');\r\n\r\nclass Chart extends Drawing {\r\n    /**\r\n     * Element representing an Excel Picture subclass of Drawing\r\n     * @property {String} kind Kind of picture\r\n     */\r\n    constructor(opts) {\r\n        super();\r\n        this.kind = 'chart';\r\n        this.type = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart';\r\n        this._title;\r\n        this.chartData = opts.chartData;\r\n\r\n        if (['oneCellAnchor', 'twoCellAnchor'].indexOf(opts.position.type) >= 0) {\r\n            this.anchor(opts.position.type, opts.position.from, opts.position.to);\r\n        } else if (opts.position.type === 'absoluteAnchor') {\r\n            this.position(opts.position.x, opts.position.y);\r\n        } else {\r\n            throw new TypeError('Invalid option for anchor type. anchorType must be one of oneCellAnchor, twoCellAnchor, or absoluteAnchor');\r\n        }\r\n    }\r\n\r\n    get name() {\r\n        return this._name;\r\n    }\r\n    set name(newName) {\r\n        this._name = newName;\r\n    }\r\n    get id() {\r\n        return this._id;\r\n    }\r\n    set id(id) {\r\n        this._id = id;\r\n    }\r\n\r\n    get rId() {\r\n        return 'rId' + this._id;\r\n    }\r\n\r\n    get description() {\r\n        return this._descr !== null ? this._descr : this._name;\r\n    }\r\n    set description(desc) {\r\n        this._descr = desc;\r\n    }\r\n\r\n    get title() {\r\n        return this._title !== null ? this._title : this._name;\r\n    }\r\n    set title(title) {\r\n        this._title = title;\r\n    }\r\n\r\n    get extension() {\r\n        return this._extension;\r\n    }\r\n\r\n    get width() {\r\n        let inWidth = this._pxWidth / 96;\r\n        let emu = new EMU(inWidth + 'in');\r\n        return emu.value;\r\n    }\r\n\r\n    get height() {\r\n        let inHeight = this._pxHeight / 96;\r\n        let emu = new EMU(inHeight + 'in');\r\n        return emu.value;\r\n    }\r\n\r\n    /**\r\n     * @alias Picture.addToXMLele\r\n     * @desc When generating Workbook output, attaches pictures to the drawings xml file\r\n     * @func Picture.addToXMLele\r\n     * @param {xmlbuilder.Element} ele Element object of the xmlbuilder module\r\n     */\r\n    addToXMLele(ele) {\r\n\r\n        let anchorEle = ele.ele('xdr:' + this.anchorType);\r\n\r\n        // if (this.editAs !== null) {\r\n        //     anchorEle.att('editAs', this.editAs);\r\n        // }\r\n\r\n        if (this.anchorType === 'absoluteAnchor') {\r\n            anchorEle.ele('xdr:pos').att('x', this._position.x).att('y', this._position.y);\r\n        }\r\n\r\n        if (this.anchorType !== 'absoluteAnchor') {\r\n            let af = this.anchorFrom;\r\n            let afEle = anchorEle.ele('xdr:from');\r\n            afEle.ele('xdr:col').text(af.col);\r\n            afEle.ele('xdr:colOff').text(af.colOff);\r\n            afEle.ele('xdr:row').text(af.row);\r\n            afEle.ele('xdr:rowOff').text(af.rowOff);\r\n        }\r\n\r\n        if (this.anchorTo && this.anchorType === 'twoCellAnchor') {\r\n            let at = this.anchorTo;\r\n            let atEle = anchorEle.ele('xdr:to');\r\n            atEle.ele('xdr:col').text(at.col);\r\n            atEle.ele('xdr:colOff').text(at.colOff);\r\n            atEle.ele('xdr:row').text(at.row);\r\n            atEle.ele('xdr:rowOff').text(at.rowOff);\r\n        }\r\n\r\n        if (this.anchorType === 'oneCellAnchor' || this.anchorType === 'absoluteAnchor') {\r\n            anchorEle.ele('xdr:ext').att('cx', this.width).att('cy', this.height);\r\n        }\r\n\r\n        let graphicFrame = anchorEle.ele('xdr:graphicFrame');\r\n        graphicFrame.att(\"macro\", \"\");\r\n        let nvGraphicFramePr = graphicFrame.ele('xdr:nvGraphicFramePr');\r\n        let cNvPrEle = nvGraphicFramePr.ele('xdr:cNvPr').att(\"id\", this.id).att(\"name\", \"Chart \" + this.id);\r\n        // this.axExtId1 = uuidv4()\r\n        // this.axExtId2 = uuidv4();\r\n\r\n        // let extLst = cNvPrEle.ele(\"a:extLst\")\r\n        // let aext = extLst.ele(\"a:ext\").att(\"uri\", this.axExtId1)\r\n        // let a16creat = aext.ele(\"a16:creationId\").att(\"xmlns:a16\", \"http://schemas.microsoft.com/office/drawing/2014/main\")\r\n        // a16creat.att(\"id\", this.axExtId2)\r\n        nvGraphicFramePr.ele(\"xdr:cNvGraphicFramePr\").ele(\"a:graphicFrameLocks\");\r\n\r\n        let xfrm = graphicFrame.ele(\"xdr:xfrm\")\r\n        xfrm.ele(\"a:off\").att(\"x\", 0).att(\"y\", 0)\r\n        xfrm.ele(\"a:ext\").att(\"cx\", 0).att(\"cy\", 0)\r\n\r\n        let graphicData = graphicFrame.ele(\"a:graphic\").ele(\"a:graphicData\").att(\"uri\", \"http://schemas.openxmlformats.org/drawingml/2006/chart\")\r\n        graphicData.ele(\"c:chart\").att(\"xmlns:c\", \"http://schemas.openxmlformats.org/drawingml/2006/chart\")\r\n            .att(\"xmlns:r\", \"http://schemas.openxmlformats.org/officeDocument/2006/relationships\")\r\n            .att(\"r:id\", this.rId)\r\n\r\n        anchorEle.ele('xdr:clientData');\r\n    }\r\n\r\n    chartPartXML(xmlcx) {\r\n        xmlcx.ele('c:date1904').att('val', 0);\r\n        xmlcx.ele('c:lang').att('val', 'en-US');\r\n        xmlcx.ele('c:roundedCorners').att('val', 0);\r\n        let xchart = xmlcx.ele('c:chart');\r\n        let title = xchart.ele('c:title');\r\n        let title_rich = title.ele('c:tx').ele('c:rich')\r\n        title_rich.ele('a:bodyPr')\r\n        title_rich.ele('a:lstStyle')\r\n        let titlep = title_rich.ele('a:p');\r\n        titlep.ele('a:pPr').ele('a:defRPr').att('sz', 1400)\r\n            .ele('a:cs').att('typeface', 'Sakkal Majalla').att('pitchFamily', 2).att('charset', '-78')\r\n        let titlepr = titlep.ele('a:r')\r\n        titlepr.ele(\"a:rPr\").att(\"sz\", 1400).att('lang', 'ar-SA')\r\n            .ele('a:cs').att('typeface', 'Sakkal Majalla').att('pitchFamily', 2).att('charset', '-78')\r\n        titlepr.ele('a:t', this.chartData.title)\r\n        titlep.ele(\"a:endParaRPr\").att(\"sz\", 1400).att('lang', 'en-US')\r\n            .ele('a:cs').att('typeface', 'Sakkal Majalla').att('pitchFamily', 2).att('charset', '-78')\r\n        title.ele(\"c:overlay\").att(\"val\", 1)\r\n\r\n        xchart.ele(\"c:autoTitleDeleted\").att(\"val\", 0);\r\n\r\n        let plotArea = xchart.ele(\"c:plotArea\")\r\n        let layout = plotArea.ele(\"c:layout\")\r\n        let ml = layout.ele('c:manualLayout')\r\n        ml.ele('c:layoutTarget').att('val', 'inner')\r\n        ml.ele('c:xMode').att('val', 'edge')\r\n        ml.ele('c:yMode').att('val', 'edge')\r\n        ml.ele('c:x').att('val', 0.1)\r\n        ml.ele('c:y').att('val', 0.1)\r\n        ml.ele('c:w').att('val', 0.75)\r\n        ml.ele('c:h').att('val', 0.6)\r\n\r\n        let barChart = plotArea.ele(\"c:barChart\")\r\n        let catAx = plotArea.ele(\"c:catAx\")\r\n        let valAx = plotArea.ele(\"c:valAx\")\r\n\r\n        barChart.ele(\"c:barDir\").att(\"val\", \"col\")\r\n        barChart.ele(\"c:grouping\").att(\"val\", \"clustered\")\r\n        barChart.ele(\"c:varyColors\").att(\"val\", 0)\r\n        for (var sno in this.chartData.dataSeries) {\r\n            var sx = this.chartData.dataSeries[sno];\r\n            // console.log(sno, sx)\r\n            let ser = barChart.ele(\"c:ser\")\r\n            ser.ele(\"c:idx\").att(\"val\", sno);\r\n            ser.ele(\"c:order\").att(\"val\", sno);\r\n            ser.ele('c:tx').ele('c:v', sx.label);\r\n            let ptrn = ser.ele('c:spPr').ele('a:pattFill').att('prst', sx.pattern);\r\n\r\n            ptrn.ele('a:fgClr').ele('a:schemeClr').att('val', 'tx1');\r\n            ptrn.ele('a:bgClr').ele('a:schemeClr').att('val', 'bg1');\r\n            ser.ele('c:invertIfNegative').att('val', 0)\r\n\r\n            if (sx.range) {\r\n                ser.ele('c:val').ele('c:numRef').ele('c:f', sx.range)\r\n            }\r\n            if (sx.catRange) {\r\n                ser.ele('c:cat').ele('c:strRef').ele('c:f', sx.catRange);\r\n            }\r\n            // ser.ele('c:extLst').ele('xmlns:c16', 'http://schemas.microsoft.com/office/drawing/2014/chart')\r\n            //     .att('uri', this.axExtId1)\r\n            //     .ele('c16:uniqueId').att('val', this.axExtId2)\r\n        }\r\n        let dLbl = barChart.ele('c:dLbls');\r\n        dLbl.ele('c:showLegendKey').att('val', 0)\r\n        dLbl.ele('c:showVal').att('val', 0)\r\n        dLbl.ele('c:showCatName').att('val', 0)\r\n        dLbl.ele('c:showSerName').att('val', 0)\r\n        dLbl.ele('c:showPercent').att('val', 0)\r\n        dLbl.ele('c:showBubbleSize').att('val', 0)\r\n\r\n        barChart.ele('c:gapWidth').att('val', 150)\r\n        barChart.ele('c:axId').att('val', 361690304)\r\n        barChart.ele('c:axId').att('val', 1)\r\n\r\n        catAx.ele('c:axId').att('val', 361690304)\r\n        catAx.ele('c:scaling').ele('c:orientation').att('val', 'minMax')\r\n        catAx.ele('c:delete').att('val', 0)\r\n        catAx.ele('c:axPos').att('val', 'b')\r\n        catAx.ele('c:numFmt').att('formatCode', 'General').att('sourceLinked', 0)\r\n        catAx.ele('c:majorTickMark').att('val', 'out')\r\n        catAx.ele('c:minorTickMark').att('val', 'none')\r\n        catAx.ele('c:tickLblPos').att('val', 'nextTo')\r\n        if(this.chartData.xlabel.font) genTxPrXML(catAx, this.chartData.xlabel.font)\r\n        catAx.ele('c:crossAx').att('val', 1)\r\n        catAx.ele('c:crosses').att('val', \"autoZero\")\r\n        catAx.ele('c:auto').att('val', 1)\r\n        catAx.ele('c:lblAlgn').att('val', \"ctr\")\r\n        catAx.ele('c:lblOffset').att('val', 100)\r\n        catAx.ele('c:noMultiLvlLbl').att('val', 0)\r\n        genTitleXML(catAx, this.chartData.xlabel)\r\n\r\n        valAx.ele('c:axId').att('val', 1)\r\n        valAx.ele('c:scaling').ele('c:orientation').att('val', 'minMax')\r\n        valAx.ele('c:delete').att('val', 0)\r\n        valAx.ele('c:axPos').att('val', 'l')\r\n        valAx.ele('c:numFmt').att('formatCode', 'General').att('sourceLinked', 1)\r\n        valAx.ele('c:majorTickMark').att('val', 'out')\r\n        valAx.ele('c:minorTickMark').att('val', 'none')\r\n        valAx.ele('c:tickLblPos').att('val', 'nextTo')\r\n        valAx.ele('c:crossAx').att('val', 361690304)\r\n        valAx.ele('c:crosses').att('val', \"autoZero\")\r\n        valAx.ele('c:crossBetween').att('val', \"between\")\r\n        genTitleXML(valAx, this.chartData.ylabel)\r\n\r\n        function genTitleXML(xmlc, txtRun) {\r\n            let xz_xlabc = xmlc.ele('c:title')\r\n            let xz_xlab = xz_xlabc.ele('c:tx').ele('c:rich')\r\n            xz_xlab.ele('a:bodyPr')\r\n            xz_xlab.ele('a:lstStyle')\r\n            let xz_xlabp = xz_xlab.ele('a:p');\r\n            xz_xlabp.ele('a:pPr').ele('a:defRPr').att('sz', txtRun.fontSize * 100)\r\n                .ele('a:cs').att('typeface', 'Sakkal Majalla').att('pitchFamily', 2).att('charset', '-78')\r\n            let xz_xlabpr = xz_xlabp.ele('a:r')\r\n            let title_txt = xz_xlabpr.ele(\"a:rPr\").att(\"sz\", txtRun.fontSize * 100).att('lang', 'ar-SA')\r\n            title_txt.ele('a:cs').att('typeface', 'Sakkal Majalla').att('pitchFamily', 2).att('charset', '-78')\r\n            if (txtRun.bold) title_txt.att('b', txtRun.bold);\r\n            if (txtRun.italic) title_txt.att('i', txtRun.italic);\r\n            title_txt.att('baseline', 0)\r\n\r\n            xz_xlabpr.ele('a:t', txtRun.value)\r\n            xz_xlabp.ele(\"a:endParaRPr\").att(\"sz\", txtRun.fontSize * 100).att('lang', 'en-US')\r\n                .ele('a:cs').att('typeface', 'Sakkal Majalla').att('pitchFamily', 2).att('charset', '-78')\r\n            xz_xlab.ele(\"c:overlay\").att(\"val\", 1)\r\n        }\r\n\r\n        function genTxPrXML(xmlc, txtRun) {\r\n            let xz_xlab = xmlc.ele('c:txPr')\r\n\r\n            xz_xlab.ele('a:bodyPr')\r\n            xz_xlab.ele('a:lstStyle')\r\n            let xz_xlabp = xz_xlab.ele('a:p');\r\n            let fx = xz_xlabp.ele('a:pPr').ele('a:defRPr').att('sz', txtRun.fontSize * 100)\r\n            fx.ele('a:cs').att('typeface', 'Sakkal Majalla').att('pitchFamily', 2).att('charset', '-78')\r\n            if (txtRun.bold) fx.att('b', txtRun.bold);\r\n            if (txtRun.italic) fx.att('i', txtRun.italic);\r\n        }\r\n\r\n\r\n        let legend = xchart.ele(\"c:legend\");\r\n        legend.ele(\"c:legendPos\").att(\"val\", \"r\");\r\n        legend.ele(\"c:overlay\").att(\"val\", \"0\");\r\n        let txPr = legend.ele(\"c:txPr\"); txPr.ele(\"a:bodyPr\");\r\n        txPr.ele(\"a:lstStyle\");\r\n        let txPrp = txPr.ele(\"a:p\");\r\n        txPrp.ele('a:pPr').ele('a:defRPr').att('sz', 1200)\r\n            .ele('a:cs').att('typeface', 'Sakkal Majalla').att('pitchFamily', 2).att('charset', '-78')\r\n        txPrp.ele(\"a:endParaRPr\").att('lang', 'en-US')\r\n        xchart.ele(\"c:plotVisOnly\").att(\"val\", 1)\r\n        xchart.ele(\"c:dispBlanksAs\").att(\"val\", \"gap\")\r\n        xchart.ele(\"c:showDLblsOverMax\").att(\"val\", 0)\r\n    }\r\n}\r\n\r\nmodule.exports = Chart;"]}