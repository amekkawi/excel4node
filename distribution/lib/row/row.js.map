{"version":3,"sources":["../../../source/lib/row/row.js"],"names":["utils","require","Row","row","ws","cellRefs","collapsed","customFormat","customHeight","hidden","ht","outlineLevel","r","s","thickBot","thickTop","h","TypeError","opts","theseFilters","filters","Array","o","autoFilter","startRow","lastRow","endRow","firstColumn","lastColumn","startCol","endCol","level","parseInt","undefined","jumpTo","sheetView","pane","state","ySplit","activePane","xSplit","topLeftCell","getExcelCellRef","getExcelRowCol","col","length","getExcelAlpha","module","exports"],"mappings":"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","file":"row.js","sourcesContent":["const utils = require('../utils.js');\r\n\r\nclass Row {\r\n    /**\r\n     * Element representing an Excel Row\r\n     * @param {Number} row Row of cell\r\n     * @param {Worksheet} Worksheet that contains row\r\n     * @property {Worksheet} ws Worksheet that contains the specified Row\r\n     * @property {Array.String} cellRefs Array of excel cell references\r\n     * @property {Boolean} collapsed States whether row is collapsed when grouped\r\n     * @property {Boolean} customFormat States whether the row has a custom format\r\n     * @property {Boolean} customHeight States whether the row's height is different than default\r\n     * @property {Boolean} hidden States whether the row is hidden\r\n     * @property {Number} ht Height of the row (internal property)\r\n     * @property {Number} outlineLevel Grouping level of row\r\n     * @property {Number} r Row index\r\n     * @property {Number} s Style index\r\n     * @property {Boolean} thickBot States whether row has a thick bottom border\r\n     * @property {Boolean} thickTop States whether row has a thick top border\r\n     * @property {Number} height Height of row\r\n     * @property {String} spans String representation of excel cell range i.e. A1:A10\r\n     * @property {Number} firstColumn Index of the first column of the row containg data\r\n     * @property {String} firstColumnAlpha Alpha representation of the first column of the row containing data\r\n     * @property {Number} lastColumn Index of the last column of the row cotaining data\r\n     * @property {String} lastColumnAlpha Alpha representation of the last column of the row containing data\r\n     */\r\n    constructor(row, ws) {\r\n        this.ws = ws;\r\n        this.cellRefs = [];\r\n        this.collapsed = null;\r\n        this.customFormat = null;\r\n        this.customHeight = null;\r\n        this.hidden = null;\r\n        this.ht = null;\r\n        this.outlineLevel = null;\r\n        this.r = row;\r\n        this.s = null;\r\n        this.thickBot = null;\r\n        this.thickTop = null;\r\n    }\r\n\r\n    set height(h) {\r\n        if (typeof h === 'number') {\r\n            this.ht = h;\r\n            this.customHeight = true;\r\n        } else {\r\n            throw new TypeError('Row height must be a number');\r\n        }\r\n        return this.ht;\r\n    }\r\n    get height() {\r\n        return this.ht;\r\n    }\r\n\r\n    /**\r\n     * @alias Row.setHeight\r\n     * @desc Sets the height of a row\r\n     * @func Row.setHeight\r\n     * @param {Number} val New Height of row\r\n     * @returns {Row} Excel Row with attached methods\r\n     */\r\n    setHeight(h) {\r\n        if (typeof h === 'number') {\r\n            this.ht = h;\r\n            this.customHeight = true;\r\n        } else {\r\n            throw new TypeError('Row height must be a number');\r\n        }\r\n        return this;\r\n    }\r\n\r\n    get spans() {\r\n        if (this.cellRefs.length > 0) {\r\n            const startCol = utils.getExcelRowCol(this.cellRefs[0]).col;\r\n            const endCol = utils.getExcelRowCol(this.cellRefs[this.cellRefs.length - 1]).col;\r\n            return `${startCol}:${endCol}`;\r\n        } else {\r\n            return null;\r\n        }\r\n    }\r\n\r\n    get firstColumn() {\r\n        if (this.cellRefs instanceof Array && this.cellRefs.length > 0) {\r\n            return utils.getExcelRowCol(this.cellRefs[0]).col;\r\n        } else {\r\n            return 1;\r\n        }\r\n    }\r\n\r\n    get firstColumnAlpha() {\r\n        if (this.cellRefs instanceof Array && this.cellRefs.length > 0) {\r\n            return utils.getExcelAlpha(utils.getExcelRowCol(this.cellRefs[0]).col);\r\n        } else {\r\n            return 'A';\r\n        }\r\n    }\r\n\r\n    get lastColumn() {\r\n        if (this.cellRefs instanceof Array && this.cellRefs.length > 0) {\r\n            return utils.getExcelRowCol(this.cellRefs[this.cellRefs.length - 1]).col;\r\n        } else {\r\n            return 1;\r\n        }\r\n    }\r\n\r\n    get lastColumnAlpha() {\r\n        if (this.cellRefs instanceof Array && this.cellRefs.length > 0) {\r\n            return utils.getExcelAlpha(utils.getExcelRowCol(this.cellRefs[this.cellRefs.length - 1]).col);\r\n        } else {\r\n            return 'A';\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @alias Row.filter\r\n     * @desc Add autofilter dropdowns to the items of the row\r\n     * @func Row.filter\r\n     * @param {Object} opts Object containing options for the fitler. \r\n     * @param {Number} opts.lastRow Last row in which the filter show effect filtered results (optional)\r\n     * @param {Number} opts.startCol First column that a filter dropdown should be added (optional)\r\n     * @param {Number} opts.lastCol Last column that a filter dropdown should be added (optional)\r\n     * @param {Array.DefinedName} opts.filters Array of filter paramaters\r\n     * @returns {Row} Excel Row with attached methods\r\n     */\r\n    filter(opts = {}) {\r\n\r\n        let theseFilters = opts.filters instanceof Array ? opts.filters : [];\r\n\r\n        let o = this.ws.opts.autoFilter;\r\n        o.startRow = this.r;\r\n        if (typeof opts.lastRow === 'number') {\r\n            o.endRow = opts.lastRow;\r\n        }\r\n\r\n        if (typeof opts.firstColumn === 'number' && typeof opts.lastColumn === 'number') {\r\n            o.startCol = opts.firstColumn;\r\n            o.endCol = opts.lastColumn;\r\n        }\r\n\r\n        // Programmer Note: DefinedName class is added to workbook during workbook write process for filters\r\n\r\n        this.ws.opts.autoFilter.filters = theseFilters;\r\n    }\r\n\r\n    /**\r\n     * @alias Row.hide\r\n     * @desc Hides the row\r\n     * @func Row.hide\r\n     * @returns {Row} Excel Row with attached methods\r\n     */\r\n    hide() {\r\n        this.hidden = true;\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @alias Row.group\r\n     * @desc Hides the row\r\n     * @func Row.group\r\n     * @param {Number} level Group level of row\r\n     * @param {Boolean} collapsed States whether group should be collapsed or expanded by default\r\n     * @returns {Row} Excel Row with attached methods\r\n     */\r\n    group(level, collapsed) {\r\n        if (parseInt(level) === level) {\r\n            this.outlineLevel = level;\r\n        } else {\r\n            throw new TypeError('Row group level must be a positive integer');\r\n        }\r\n\r\n        if (collapsed === undefined) {\r\n            return this;\r\n        }\r\n\r\n        if (typeof collapsed === 'boolean') {\r\n            this.collapsed = collapsed;\r\n            this.hidden = collapsed;\r\n        } else {\r\n            throw new TypeError('Row group collapse flag must be a boolean');\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @alias Row.freeze\r\n     * @desc Creates Worksheet panes and freezes the top pane\r\n     * @func Row.freeze\r\n     * @param {Number} jumpTo Row that the bottom pane should be scrolled to by default\r\n     * @returns {Row} Excel Row with attached methods\r\n     */\r\n    freeze(jumpTo) {\r\n        let o = this.ws.opts.sheetView.pane;\r\n        jumpTo = typeof jumpTo === 'number' && jumpTo > this.r ? jumpTo : this.r + 1;\r\n        o.state = 'frozen';\r\n        o.ySplit = this.r;\r\n        o.activePane = 'bottomRight';\r\n        o.xSplit === null ?\r\n            o.topLeftCell = utils.getExcelCellRef(jumpTo, 1) :\r\n            o.topLeftCell = utils.getExcelCellRef(jumpTo, utils.getExcelRowCol(o.topLeftCell).col);\r\n        return this;\r\n    }\r\n}\r\n\r\nmodule.exports = Row;"]}