{"version":3,"sources":["../../../../source/lib/style/classes/font.js"],"names":["xmlbuilder","require","types","Font","opts","color","excelColor","getColor","name","scheme","size","family","fontFamily","validate","vertAlign","charset","condense","extend","bold","italics","outline","shadow","strike","underline","obj","fontXML","fEle","ele","att","undefined","toLowerCase","module","exports"],"mappings":";;;;;;AAAA,IAAMA,aAAaC,QAAQ,YAAR,CAAnB;AACA,IAAMC,QAAQD,QAAQ,sBAAR,CAAd;;IAEME,I;AACF;;;;;;;;;;;;;;;;;;;;;AAqBA,sBAAYC,IAAZ,EAAkB;AAAA;;AACdA,uBAAOA,OAAOA,IAAP,GAAc,EAArB;;AAEA,uBAAOA,KAAKC,KAAZ,KAAsB,QAAtB,GAAiC,KAAKA,KAAL,GAAaH,MAAMI,UAAN,CAAiBC,QAAjB,CAA0BH,KAAKC,KAA/B,CAA9C,GAAsF,IAAtF;AACA,uBAAOD,KAAKI,IAAZ,KAAqB,QAArB,GAAgC,KAAKA,IAAL,GAAYJ,KAAKI,IAAjD,GAAwD,IAAxD;AACA,uBAAOJ,KAAKK,MAAZ,KAAuB,QAAvB,GAAkC,KAAKA,MAAL,GAAcL,KAAKK,MAArD,GAA8D,IAA9D;AACA,uBAAOL,KAAKM,IAAZ,KAAqB,QAArB,GAAgC,KAAKA,IAAL,GAAYN,KAAKM,IAAjD,GAAwD,IAAxD;AACA,uBAAON,KAAKO,MAAZ,KAAuB,QAAvB,IAAmCT,MAAMU,UAAN,CAAiBC,QAAjB,CAA0BT,KAAKO,MAA/B,MAA2C,IAA9E,GAAqF,KAAKA,MAAL,GAAcP,KAAKO,MAAxG,GAAiH,IAAjH;;AAEA,uBAAOP,KAAKU,SAAZ,KAA0B,QAA1B,GAAqC,KAAKA,SAAL,GAAiBV,KAAKU,SAA3D,GAAuE,IAAvE;AACA,uBAAOV,KAAKW,OAAZ,KAAwB,QAAxB,GAAmC,KAAKA,OAAL,GAAeX,KAAKW,OAAvD,GAAiE,IAAjE;;AAEA,uBAAOX,KAAKY,QAAZ,KAAyB,SAAzB,GAAqC,KAAKA,QAAL,GAAgBZ,KAAKY,QAA1D,GAAqE,IAArE;AACA,uBAAOZ,KAAKa,MAAZ,KAAuB,SAAvB,GAAmC,KAAKA,MAAL,GAAcb,KAAKa,MAAtD,GAA+D,IAA/D;AACA,uBAAOb,KAAKc,IAAZ,KAAqB,SAArB,GAAiC,KAAKA,IAAL,GAAYd,KAAKc,IAAlD,GAAyD,IAAzD;AACA,uBAAOd,KAAKe,OAAZ,KAAwB,SAAxB,GAAoC,KAAKA,OAAL,GAAef,KAAKe,OAAxD,GAAkE,IAAlE;AACA,uBAAOf,KAAKgB,OAAZ,KAAwB,SAAxB,GAAoC,KAAKA,OAAL,GAAehB,KAAKgB,OAAxD,GAAkE,IAAlE;AACA,uBAAOhB,KAAKiB,MAAZ,KAAuB,SAAvB,GAAmC,KAAKA,MAAL,GAAcjB,KAAKiB,MAAtD,GAA+D,IAA/D;AACA,uBAAOjB,KAAKkB,MAAZ,KAAuB,SAAvB,GAAmC,KAAKA,MAAL,GAAclB,KAAKkB,MAAtD,GAA+D,IAA/D;AACA,uBAAOlB,KAAKmB,SAAZ,KAA0B,SAA1B,GAAsC,KAAKA,SAAL,GAAiBnB,KAAKmB,SAA5D,GAAwE,IAAxE;AACH;;AAED;;;;;;;;;2CAKW;AACP,4BAAIC,MAAM,EAAV;;AAEA,+BAAO,KAAKT,OAAZ,KAAwB,QAAxB,GAAmCS,IAAIT,OAAJ,GAAc,KAAKA,OAAtD,GAAgE,IAAhE;AACA,+BAAO,KAAKV,KAAZ,KAAsB,QAAtB,GAAiCmB,IAAInB,KAAJ,GAAY,KAAKA,KAAlD,GAA0D,IAA1D;AACA,+BAAO,KAAKM,MAAZ,KAAuB,QAAvB,GAAkCa,IAAIb,MAAJ,GAAa,KAAKA,MAApD,GAA6D,IAA7D;AACA,+BAAO,KAAKH,IAAZ,KAAqB,QAArB,GAAgCgB,IAAIhB,IAAJ,GAAW,KAAKA,IAAhD,GAAuD,IAAvD;AACA,+BAAO,KAAKC,MAAZ,KAAuB,QAAvB,GAAkCe,IAAIf,MAAJ,GAAa,KAAKA,MAApD,GAA6D,IAA7D;AACA,+BAAO,KAAKC,IAAZ,KAAqB,QAArB,GAAgCc,IAAId,IAAJ,GAAW,KAAKA,IAAhD,GAAuD,IAAvD;AACA,+BAAO,KAAKI,SAAZ,KAA0B,QAA1B,GAAqCU,IAAIV,SAAJ,GAAgB,KAAKA,SAA1D,GAAsE,IAAtE;;AAEA,+BAAO,KAAKE,QAAZ,KAAyB,SAAzB,GAAqCQ,IAAIR,QAAJ,GAAe,KAAKA,QAAzD,GAAoE,IAApE;AACA,+BAAO,KAAKC,MAAZ,KAAuB,SAAvB,GAAmCO,IAAIP,MAAJ,GAAa,KAAKA,MAArD,GAA8D,IAA9D;AACA,+BAAO,KAAKC,IAAZ,KAAqB,SAArB,GAAiCM,IAAIN,IAAJ,GAAW,KAAKA,IAAjD,GAAwD,IAAxD;AACA,+BAAO,KAAKC,OAAZ,KAAwB,SAAxB,GAAoCK,IAAIL,OAAJ,GAAc,KAAKA,OAAvD,GAAiE,IAAjE;AACA,+BAAO,KAAKC,OAAZ,KAAwB,SAAxB,GAAoCI,IAAIJ,OAAJ,GAAc,KAAKA,OAAvD,GAAiE,IAAjE;AACA,+BAAO,KAAKC,MAAZ,KAAuB,SAAvB,GAAmCG,IAAIH,MAAJ,GAAa,KAAKA,MAArD,GAA8D,IAA9D;AACA,+BAAO,KAAKC,MAAZ,KAAuB,SAAvB,GAAmCE,IAAIF,MAAJ,GAAa,KAAKA,MAArD,GAA8D,IAA9D;AACA,+BAAO,KAAKC,SAAZ,KAA0B,SAA1B,GAAsCC,IAAID,SAAJ,GAAgB,KAAKA,SAA3D,GAAuE,IAAvE;;AAEA,+BAAOC,GAAP;AACH;;AAED;;;;;;;;;4CAMYC,O,EAAS;AACjB,4BAAIC,OAAOD,QAAQE,GAAR,CAAY,MAAZ,CAAX;;AAEA;AACA,6BAAKX,QAAL,KAAkB,IAAlB,GAAyBU,KAAKC,GAAL,CAAS,UAAT,CAAzB,GAAgD,IAAhD;AACA,6BAAKV,MAAL,KAAgB,IAAhB,GAAuBS,KAAKC,GAAL,CAAS,QAAT,CAAvB,GAA4C,IAA5C;AACA,6BAAKT,IAAL,KAAc,IAAd,GAAqBQ,KAAKC,GAAL,CAAS,GAAT,CAArB,GAAqC,IAArC;AACA,6BAAKR,OAAL,KAAiB,IAAjB,GAAwBO,KAAKC,GAAL,CAAS,GAAT,CAAxB,GAAwC,IAAxC;AACA,6BAAKP,OAAL,KAAiB,IAAjB,GAAwBM,KAAKC,GAAL,CAAS,SAAT,CAAxB,GAA8C,IAA9C;AACA,6BAAKN,MAAL,KAAgB,IAAhB,GAAuBK,KAAKC,GAAL,CAAS,QAAT,CAAvB,GAA4C,IAA5C;AACA,6BAAKL,MAAL,KAAgB,IAAhB,GAAuBI,KAAKC,GAAL,CAAS,QAAT,CAAvB,GAA4C,IAA5C;AACA,6BAAKJ,SAAL,KAAmB,IAAnB,GAA0BG,KAAKC,GAAL,CAAS,GAAT,CAA1B,GAA0C,IAA1C;AACA,6BAAKb,SAAL,KAAmB,IAAnB,GAA0BY,KAAKC,GAAL,CAAS,WAAT,CAA1B,GAAkD,IAAlD;;AAEAD,6BAAKC,GAAL,CAAS,IAAT,EAAeC,GAAf,CAAmB,KAAnB,EAA0B,KAAKlB,IAAL,KAAcmB,SAAd,GAA0B,KAAKnB,IAA/B,GAAsC,EAAhE;AACAgB,6BAAKC,GAAL,CAAS,OAAT,EAAkBC,GAAlB,CAAsB,KAAtB,EAA6B,KAAKvB,KAAL,KAAewB,SAAf,GAA2B,KAAKxB,KAAhC,GAAwC,UAArE;AACAqB,6BAAKC,GAAL,CAAS,MAAT,EAAiBC,GAAjB,CAAqB,KAArB,EAA4B,KAAKpB,IAAL,KAAcqB,SAAd,GAA0B,KAAKrB,IAA/B,GAAsC,SAAlE;AACA,4BAAI,KAAKG,MAAL,KAAgBkB,SAApB,EAA+B;AAC3BH,qCAAKC,GAAL,CAAS,QAAT,EAAmBC,GAAnB,CAAuB,KAAvB,EAA8B1B,MAAMU,UAAN,CAAiB,KAAKD,MAAL,CAAYmB,WAAZ,EAAjB,CAA9B;AACH;AACD,4BAAI,KAAKrB,MAAL,KAAgBoB,SAApB,EAA+B;AAC3BH,qCAAKC,GAAL,CAAS,QAAT,EAAmBC,GAAnB,CAAuB,KAAvB,EAA8B,KAAKnB,MAAnC;AACH;;AAGD,+BAAO,IAAP;AACH;;;;;;AAKLsB,OAAOC,OAAP,GAAiB7B,IAAjB","file":"font.js","sourcesContent":["const xmlbuilder = require('xmlbuilder');\r\nconst types = require('../../types/index.js');\r\n\r\nclass Font {\r\n    /**\r\n     * @class Font\r\n     * @desc Instance of Font with properties\r\n     * @param {Object} opts Options for Font\r\n     * @param {String} opts.color HEX color of font\r\n     * @param {String} opts.name Name of Font. i.e. Calibri\r\n     * @param {String} opts.scheme Font Scheme. defaults to major\r\n     * @param {Number} opts.size Pt size of Font\r\n     * @param {String} opts.family Font Family. defaults to roman\r\n     * @param {String} opts.vertAlign Specifies font as subscript or superscript\r\n     * @param {Number} opts.charset Character set of font as defined in ยง18.4.1 charset (Character Set) or standard\r\n     * @param {Boolean} opts.condense Macintosh compatibility settings to squeeze text together when rendering\r\n     * @param {Boolean} opts.extend Stretches out the text when rendering\r\n     * @param {Boolean} opts.bold States whether font should be bold\r\n     * @param {Boolean} opts.italics States whether font should be in italics\r\n     * @param {Boolean} opts.outline States whether font should be outlined\r\n     * @param {Boolean} opts.shadow States whether font should have a shadow\r\n     * @param {Boolean} opts.strike States whether font should have a strikethrough\r\n     * @param {Boolean} opts.underline States whether font should be underlined\r\n     * @retuns {Font}\r\n     */\r\n    constructor(opts) {\r\n        opts = opts ? opts : {};\r\n\r\n        typeof opts.color === 'string' ? this.color = types.excelColor.getColor(opts.color) : null;\r\n        typeof opts.name === 'string' ? this.name = opts.name : null;\r\n        typeof opts.scheme === 'string' ? this.scheme = opts.scheme : null;\r\n        typeof opts.size === 'number' ? this.size = opts.size : null;\r\n        typeof opts.family === 'string' && types.fontFamily.validate(opts.family) === true ? this.family = opts.family : null;\r\n\r\n        typeof opts.vertAlign === 'string' ? this.vertAlign = opts.vertAlign : null;\r\n        typeof opts.charset === 'number' ? this.charset = opts.charset : null;\r\n\r\n        typeof opts.condense === 'boolean' ? this.condense = opts.condense : null;\r\n        typeof opts.extend === 'boolean' ? this.extend = opts.extend : null;\r\n        typeof opts.bold === 'boolean' ? this.bold = opts.bold : null;\r\n        typeof opts.italics === 'boolean' ? this.italics = opts.italics : null;\r\n        typeof opts.outline === 'boolean' ? this.outline = opts.outline : null;\r\n        typeof opts.shadow === 'boolean' ? this.shadow = opts.shadow : null;\r\n        typeof opts.strike === 'boolean' ? this.strike = opts.strike : null;\r\n        typeof opts.underline === 'boolean' ? this.underline = opts.underline : null;\r\n    }\r\n\r\n    /** \r\n     * @func Font.toObject\r\n     * @desc Converts the Font instance to a javascript object\r\n     * @returns {Object}\r\n     */\r\n    toObject() {\r\n        let obj = {};\r\n\r\n        typeof this.charset === 'number' ? obj.charset = this.charset : null;\r\n        typeof this.color === 'string' ? obj.color = this.color : null;\r\n        typeof this.family === 'string' ? obj.family = this.family : null;\r\n        typeof this.name === 'string' ? obj.name = this.name : null;\r\n        typeof this.scheme === 'string' ? obj.scheme = this.scheme : null;\r\n        typeof this.size === 'number' ? obj.size = this.size : null;\r\n        typeof this.vertAlign === 'string' ? obj.vertAlign = this.vertAlign : null;\r\n\r\n        typeof this.condense === 'boolean' ? obj.condense = this.condense : null;\r\n        typeof this.extend === 'boolean' ? obj.extend = this.extend : null;\r\n        typeof this.bold === 'boolean' ? obj.bold = this.bold : null;\r\n        typeof this.italics === 'boolean' ? obj.italics = this.italics : null;\r\n        typeof this.outline === 'boolean' ? obj.outline = this.outline : null;\r\n        typeof this.shadow === 'boolean' ? obj.shadow = this.shadow : null;\r\n        typeof this.strike === 'boolean' ? obj.strike = this.strike : null;\r\n        typeof this.underline === 'boolean' ? obj.underline = this.underline : null;\r\n\r\n        return obj;\r\n    }\r\n\r\n    /**\r\n     * @alias Font.addToXMLele\r\n     * @desc When generating Workbook output, attaches style to the styles xml file\r\n     * @func Font.addToXMLele\r\n     * @param {xmlbuilder.Element} ele Element object of the xmlbuilder module\r\n     */\r\n    addToXMLele(fontXML) {\r\n        let fEle = fontXML.ele('font');\r\n\r\n        // Place styling elements first to avoid validation errors with .NET validator\r\n        this.condense === true ? fEle.ele('condense') : null;\r\n        this.extend === true ? fEle.ele('extend') : null;\r\n        this.bold === true ? fEle.ele('b') : null;\r\n        this.italics === true ? fEle.ele('i') : null;\r\n        this.outline === true ? fEle.ele('outline') : null;\r\n        this.shadow === true ? fEle.ele('shadow') : null;\r\n        this.strike === true ? fEle.ele('strike') : null;\r\n        this.underline === true ? fEle.ele('u') : null;\r\n        this.vertAlign === true ? fEle.ele('vertAlign') : null;\r\n\r\n        fEle.ele('sz').att('val', this.size !== undefined ? this.size : 12);\r\n        fEle.ele('color').att('rgb', this.color !== undefined ? this.color : 'FF000000');\r\n        fEle.ele('name').att('val', this.name !== undefined ? this.name : 'Calibri');\r\n        if (this.family !== undefined) {\r\n            fEle.ele('family').att('val', types.fontFamily[this.family.toLowerCase()]);\r\n        }\r\n        if (this.scheme !== undefined) {\r\n            fEle.ele('scheme').att('val', this.scheme);\r\n        }\r\n\r\n\r\n        return true;\r\n    }\r\n\r\n\r\n}\r\n\r\nmodule.exports = Font;"]}