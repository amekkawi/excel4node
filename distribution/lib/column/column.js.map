{"version":3,"sources":["../../../source/lib/column/column.js"],"names":["utils","require","Column","col","ws","collapsed","customWidth","hidden","max","min","outlineLevel","style","colWidth","w","width","level","parseInt","TypeError","undefined","jumpTo","o","opts","sheetView","pane","state","xSplit","activePane","ySplit","topLeftCell","getExcelCellRef","getExcelRowCol","row","module","exports"],"mappings":";;;;;;AAAA,IAAMA,QAAQC,QAAQ,aAAR,CAAd;;IAEMC,M;AACF;;;;;;;;;;;;;;AAcA,oBAAYC,GAAZ,EAAiBC,EAAjB,EAAqB;AAAA;;AACjB,aAAKA,EAAL,GAAUA,EAAV;AACA,aAAKC,SAAL,GAAiB,IAAjB;AACA,aAAKC,WAAL,GAAmB,IAAnB;AACA,aAAKC,MAAL,GAAc,IAAd;AACA,aAAKC,GAAL,GAAWL,GAAX;AACA,aAAKM,GAAL,GAAWN,GAAX;AACA,aAAKO,YAAL,GAAoB,IAApB;AACA,aAAKC,KAAL,GAAa,IAAb;AACA,aAAKC,QAAL,GAAgB,IAAhB;AACH;;;;;;AAgBD;;;;;;;iCAOSC,C,EAAG;AACR,iBAAKC,KAAL,GAAaD,CAAb;AACA,mBAAO,IAAP;AACH;;AAED;;;;;;;;;+BAMO;AACH,iBAAKN,MAAL,GAAc,IAAd;AACA,mBAAO,IAAP;AACH;;AAED;;;;;;;;;;;8BAQMQ,K,EAAOV,S,EAAW;AACpB,gBAAIW,SAASD,KAAT,MAAoBA,KAAxB,EAA+B;AAC3B,qBAAKL,YAAL,GAAoBK,KAApB;AACH,aAFD,MAEO;AACH,sBAAM,IAAIE,SAAJ,CAAc,+CAAd,CAAN;AACH;;AAED,gBAAIZ,cAAca,SAAlB,EAA6B;AACzB,uBAAO,IAAP;AACH;;AAED,gBAAI,OAAOb,SAAP,KAAqB,SAAzB,EAAoC;AAChC,qBAAKA,SAAL,GAAiBA,SAAjB;AACA,qBAAKE,MAAL,GAAcF,SAAd;AACH,aAHD,MAGO;AACH,sBAAM,IAAIY,SAAJ,CAAc,8CAAd,CAAN;AACH;;AAED,mBAAO,IAAP;AACH;;AAED;;;;;;;;;;+BAOOE,M,EAAQ;AACX,gBAAIC,IAAI,KAAKhB,EAAL,CAAQiB,IAAR,CAAaC,SAAb,CAAuBC,IAA/B;AACAJ,qBAAS,OAAOA,MAAP,KAAkB,QAAlB,IAA8BA,SAAS,KAAKV,GAA5C,GAAkDU,MAAlD,GAA2D,KAAKV,GAAL,GAAW,CAA/E;AACAW,cAAEI,KAAF,GAAU,QAAV;AACAJ,cAAEK,MAAF,GAAW,KAAKhB,GAAhB;AACAW,cAAEM,UAAF,GAAe,aAAf;AACAN,cAAEO,MAAF,KAAa,IAAb,GACIP,EAAEQ,WAAF,GAAgB5B,MAAM6B,eAAN,CAAsB,CAAtB,EAAyBV,MAAzB,CADpB,GAEIC,EAAEQ,WAAF,GAAgB5B,MAAM6B,eAAN,CAAsB7B,MAAM8B,cAAN,CAAqBV,EAAEQ,WAAvB,EAAoCG,GAA1D,EAA+DZ,MAA/D,CAFpB;AAGA,mBAAO,IAAP;AACH;;;4BAnFW;AACR,mBAAO,KAAKP,QAAZ;AACH,S;0BAESC,C,EAAG;AACT,gBAAI,OAAOA,CAAP,KAAa,QAAjB,EAA2B;AACvB,qBAAKD,QAAL,GAAgBC,CAAhB;AACA,qBAAKP,WAAL,GAAmB,IAAnB;AACH,aAHD,MAGO;AACH,sBAAM,IAAIW,SAAJ,CAAc,+BAAd,CAAN;AACH;AACD,mBAAO,KAAKL,QAAZ;AACH;;;;;;AA0ELoB,OAAOC,OAAP,GAAiB/B,MAAjB","file":"column.js","sourcesContent":["const utils = require('../utils.js');\r\n\r\nclass Column {\r\n    /**\r\n     * Element representing an Excel Column\r\n     * @param {Number} col Column of cell\r\n     * @param {Worksheet} Worksheet that contains column\r\n     * @property {Worksheet} ws Worksheet that contains the specified Column\r\n     * @property {Boolean} collapsed States whether the column is collapsed if part of a group\r\n     * @property {Boolean} customWidth States whether or not the column as a width that is not default\r\n     * @property {Boolean} hidden States whether or not the specified column is hiddent\r\n     * @property {Number} max The greatest column if part of a range\r\n     * @property {Number} min The least column if part of a range\r\n     * @property {Number} outlineLevel The grouping leve of the Column\r\n     * @property {Number} style ID of style\r\n     * @property {Number} width Width of the Column\r\n     */\r\n    constructor(col, ws) {\r\n        this.ws = ws;\r\n        this.collapsed = null;\r\n        this.customWidth = null;\r\n        this.hidden = null;\r\n        this.max = col;\r\n        this.min = col;\r\n        this.outlineLevel = null;\r\n        this.style = null;\r\n        this.colWidth = null;\r\n    }\r\n\r\n    get width() {\r\n        return this.colWidth;\r\n    }\r\n\r\n    set width(w) {\r\n        if (typeof w === 'number') {\r\n            this.colWidth = w;\r\n            this.customWidth = true;\r\n        } else {\r\n            throw new TypeError('Column width must be a number');\r\n        }\r\n        return this.colWidth;\r\n    }\r\n\r\n    /**\r\n     * @alias Column.setWidth\r\n     * @desc Sets teh width of a column\r\n     * @func Column.setWidth\r\n     * @param {Number} val New Width of column\r\n     * @returns {Column} Excel Column with attached methods\r\n     */\r\n    setWidth(w) {\r\n        this.width = w;\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @alias Column.hide\r\n     * @desc Sets a Column to be hidden\r\n     * @func Column.hide\r\n     * @returns {Column} Excel Column with attached methods\r\n     */\r\n    hide() {\r\n        this.hidden = true;\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @alias Column.group\r\n     * @desc Adds column to the specified group\r\n     * @func Column.group\r\n     * @param {Number} level Level of excel grouping\r\n     * @param {Boolean} collapsed States wheter column grouping level should be collapsed by default\r\n     * @returns {Column} Excel Column with attached methods\r\n     */\r\n    group(level, collapsed) {\r\n        if (parseInt(level) === level) {\r\n            this.outlineLevel = level;\r\n        } else {\r\n            throw new TypeError('Column group level must be a positive integer');\r\n        }\r\n\r\n        if (collapsed === undefined) {\r\n            return this;\r\n        }\r\n\r\n        if (typeof collapsed === 'boolean') {\r\n            this.collapsed = collapsed;\r\n            this.hidden = collapsed;\r\n        } else {\r\n            throw new TypeError('Column group collapse flag must be a boolean');\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @alias Column.freeze\r\n     * @desc Creates an Excel pane at the specificed column and Freezes that column from scolling\r\n     * @func Column.freeze\r\n     * @param {Number} jumptTo Specifies the column that the active pane will be scrolled to by default\r\n     * @returns {Column} Excel Column with attached methods\r\n     */\r\n    freeze(jumpTo) {\r\n        let o = this.ws.opts.sheetView.pane;\r\n        jumpTo = typeof jumpTo === 'number' && jumpTo > this.min ? jumpTo : this.min + 1;\r\n        o.state = 'frozen';\r\n        o.xSplit = this.min;\r\n        o.activePane = 'bottomRight';\r\n        o.ySplit === null ?\r\n            o.topLeftCell = utils.getExcelCellRef(1, jumpTo) :\r\n            o.topLeftCell = utils.getExcelCellRef(utils.getExcelRowCol(o.topLeftCell).row, jumpTo);\r\n        return this;\r\n    }\r\n}\r\n\r\nmodule.exports = Column;"]}